<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Keyword Search</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/static/style.css" />

    <script src="http://d3js.org/d3.v2.min.js?2.9.3"></script>

</head>
<body>
    <div class="container">


        <div id="KeyWordSearch" class="searching">
            <h3>Keyword Search In Graph DB</h3>
            <form  role="search" method="GET" action="/search/">

                {% csrf_token %}
                <div class="input-group input-group-lg">
                    <input class="form-control" placeholder="Search ..." name="keyword" id="keyword" type="text" aria-describedby="sizing-addon1">
                    <div class="input-group-btn">
                        <button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button>
                    </div>
                </div>
            </form>

            <div class="information" id="information">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        Information sur le noeud
                    </div>
                    <div class="panel-body">
                        <table></table>
                    </div>
                </div>
            </div>
            <div id="result" >
                <div id="graph">
                </div>
            </div>
        </div>


        <div class="footer">
            <hr>Copyright  <div class="right">{{ temps }}</div>
        </div>
    </div>



    <script src="/static/graph.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#KeyWordSearch").submit(getKeyword);
        });
        
        window.loadInformation = function (data) {
            //alert("test");
            var table = document.querySelector('table');
            var rows = '';
            for ( p in data) {
              for ( k in data[p]) {
                rows += '<tr><td>' + k + '</td><td>' + data[p][k] + '</td></tr>'
              }
            }
            table.innerHTML = rows;

            document.getElementById("information").style.visibility = "visible";
        }

        function getKeyword() {
            $keyW = $("#keyword").val();
            $.ajax({
                url: '/search',
                data: ({key: $keyW }),
                type: 'GET',
                success: function ($data) {
                    document.getElementById("graph").innerHTML = "";
                    for(i=0;i<$data;i++) {
                        creatGraph(i);
                    }

                }
            });
            return false;
        }

    </script>

</body>
</html>